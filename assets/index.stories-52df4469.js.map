{"version":3,"file":"index.stories-52df4469.js","sources":["../../src/components/ghostArea/index.tsx"],"sourcesContent":["import './index.less';\n\nimport classNames from 'classnames';\nimport React, { MouseEventHandler, PropsWithChildren } from 'react';\n\nimport { GhostContext } from '../../context';\nimport { IGhostContextValue, ILocation } from '../../typings';\n\nexport interface IGhostAreaProps extends Pick<React.CSSProperties, 'width' | 'height'> {\n  className?: string;\n}\n\nexport const GhostArea: React.FC<PropsWithChildren<IGhostAreaProps>> = ({\n  children,\n  className,\n  width,\n  height,\n}) => {\n  const area = React.useRef<HTMLDivElement>(null);\n  const [activeLocation, setActiveLocation] = React.useState<ILocation | null>(null);\n  const [isActive, setIsActive] = React.useState<boolean>(false);\n\n  const onMouseDown = React.useCallback<MouseEventHandler>((e) => {\n    if (!area.current) return;\n    const { left, top, width: w, height: h } = area.current.getBoundingClientRect();\n    const nextLeft = e.clientX - left;\n    const nextTop = e.clientY - top;\n    const isValid = nextTop >= 0 && nextTop <= h && w >= 0 && nextLeft <= w;\n\n    if (!isValid) return;\n    setActiveLocation({\n      left: nextLeft,\n      top: nextTop,\n    });\n    setIsActive(true);\n  }, []);\n\n  const ghostProviderValue = React.useMemo((): IGhostContextValue => {\n    return {\n      isActive,\n      ghost: true,\n      getGhostArea: () => area.current,\n    };\n  }, [isActive]);\n\n  const onMouseUp = React.useCallback(() => {\n    setIsActive(false);\n  }, []);\n\n  React.useEffect(() => {\n    document.addEventListener('mouseup', onMouseUp);\n\n    return () => {\n      document.removeEventListener('mouseup', onMouseUp);\n    };\n  }, [onMouseUp]);\n\n  const cls = React.useMemo(() => {\n    return classNames('react-joystick-ghost-area', className);\n  }, [className]);\n\n  const style = React.useMemo((): React.CSSProperties => {\n    return { height, width };\n  }, [height, width]);\n\n  return (\n    <div ref={area} className={cls} onMouseDown={onMouseDown} style={style}>\n      <div\n        className=\"react-joystick-wrapper\"\n        style={{ left: activeLocation?.left, top: activeLocation?.top }}\n      >\n        <GhostContext.Provider value={ghostProviderValue}>{children}</GhostContext.Provider>\n      </div>\n    </div>\n  );\n};\n"],"names":["GhostArea","children","className","width","height","area","React","activeLocation","setActiveLocation","isActive","setIsActive","onMouseDown","e","left","top","w","h","nextLeft","nextTop","ghostProviderValue","onMouseUp","cls","classNames","style","jsx","GhostContext"],"mappings":"8KAYO,MAAAA,EAAA,CAAA,CAAiE,SAAAC,EACtE,UAAAC,EACA,MAAAC,EACA,OAAAC,CAEF,IAAA,CACE,MAAAC,EAAAC,EAAA,OAAA,IAAA,EACA,CAAAC,EAAAC,CAAA,EAAAF,EAAA,SAAA,IAAA,EACA,CAAAG,EAAAC,CAAA,EAAAJ,EAAA,SAAA,EAAA,EAEAK,EAAAL,EAAA,YAAAM,GAAA,CACE,GAAA,CAAAP,EAAA,QAAmB,OACnB,KAAA,CAAA,KAAAQ,EAAA,IAAAC,EAAA,MAAAC,EAAA,OAAAC,GAAAX,EAAA,QAAA,sBAAA,EACAY,EAAAL,EAAA,QAAAC,EACAK,EAAAN,EAAA,QAAAE,EACAI,GAAA,GAAAA,GAAAF,GAAAD,GAAA,GAAAE,GAAAF,IAGAP,EAAA,CAAkB,KAAAS,EACV,IAAAC,CACD,CAAA,EAEPR,EAAA,EAAA,EAAgB,EAAA,CAAA,CAAA,EAGlBS,EAAAb,EAAA,QAAA,KACE,CAAO,SAAAG,EACL,MAAA,GACO,aAAA,IAAAJ,EAAA,OACkB,GAC3B,CAAAI,CAAA,CAAA,EAGFW,EAAAd,EAAA,YAAA,IAAA,CACEI,EAAA,EAAA,CAAiB,EAAA,CAAA,CAAA,EAGnBJ,EAAA,UAAA,KACE,SAAA,iBAAA,UAAAc,CAAA,EAEA,IAAA,CACE,SAAA,oBAAA,UAAAA,CAAA,CAAiD,GACnD,CAAAA,CAAA,CAAA,EAGF,MAAAC,EAAAf,EAAA,QAAA,IACEgB,EAAA,4BAAApB,CAAA,EAAwD,CAAAA,CAAA,CAAA,EAG1DqB,EAAAjB,EAAA,QAAA,KACE,CAAA,OAAAF,EAAA,MAAAD,IAAuB,CAAAC,EAAAD,CAAA,CAAA,EAGzB,OAAAqB,EAAA,MAAA,CAAA,IAAAnB,EAAA,UAAAgB,EAAA,YAAAV,EAAA,MAAAY,EAAA,SAAAC,EAEI,MAAC,CAAA,UAAA,yBACW,MAAA,CAAA,KAAAjB,GAAA,YAAAA,EAAA,KAAA,IAAAA,GAAA,YAAAA,EAAA,GAAA,EACoD,SAAAiB,EAAAC,EAAA,SAAA,CAAA,MAAAN,EAAA,SAAAlB,EAAA,CAEF,CAAA,CAAA,CAAA,CAIpE"}